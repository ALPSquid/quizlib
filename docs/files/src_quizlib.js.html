<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/quizlib.js - quizlib</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="quizlib" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Quiz.html">Quiz</a></li>
                                <li><a href="../classes/QuizResult.html">QuizResult</a></li>
                                <li><a href="../classes/Utils.html">Utils</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/quizlib.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Class that represents an HTML Quiz. Provides methods for checking answers and generating a score.  
 *
 * To use:  
 * *Note:* Required classes are not exclusive; you can still use your own classes alongside them.  
 *
 * **HTML**  
 * Import the QuizLib.js script and optional QuizLibStyle.css stylesheet. The stylesheet provides basic formatting but styling is left open to you.
 * - Create a quiz container element containing child elements for each question. Each question element must use the &#x27;question&#x27; class.
 * - Each question element must have a question title element using the class &#x27;question-title&#x27;. The unanswered question warning will be appended to this element.
 * - Each question element must also have a question answers element using the class &#x27;question-answers&#x27;. This element must contain answers that use the input tag. You can use any input type, quantity and structure you like.
 * - Each answer input must have an arbitrary value which will be used as its answer value.
 * 
 * QuizLib makes use of the following classes (See {{#crossLink &quot;Quiz/Classes:property&quot;}}{{/crossLink}}):
 * - &#x27;quizlib-question&#x27;: used to identify a question element
 * - &#x27;quizlib-question-title&#x27;: used to identify the question title element
 * - &#x27;quizlib-question-answers&#x27;: used to identify the element containing question answers
 * - &#x27;quizlib-question-warning&#x27;: used by the &#x27;unanswered question warning&#x27; element
 * - &#x27;quizlib-correct&#x27;: added to question titles to highlight correctly answered questions. 
 *    Use freely to take advantage of {{#crossLink &quot;Quiz/highlightResults:method&quot;}}{{/crossLink}} and {{#crossLink &quot;Quiz/clearHighlights:method&quot;}}{{/crossLink}}
 * - &#x27;quizlib-incorrect&#x27;: added to question titles to highlight incorrectly answered questions.
 *    Use freely to take advantage of {{#crossLink &quot;Quiz/highlightResults:method&quot;}}{{/crossLink}} and {{#crossLink &quot;Quiz/clearHighlights:method&quot;}}{{/crossLink}}
 *
 * *Example:*  
 * &#x60;&#x60;&#x60;
 * &lt;!-- Quiz Container --&gt;  
 * &lt;div id=&quot;quiz-div&quot;&gt;  
 *     &lt;!-- Question 1 --&gt;  
 *     &lt;div class=&quot;quizlib-question my-class&quot;&gt;  
 *         &lt;div class=&quot;quizlib-question-title&quot;&gt;1. Question Title&lt;/div&gt;  
 *         &lt;div class=&quot;quizlib-question-answers&quot;&gt;  
 *             &lt;!-- Answer structure can be as simple or as complicated as you like, only the input element matters to the library --&gt;
 *             &lt;input type=&quot;radio&quot; name=&quot;q1&quot; value=&quot;a&quot;&gt; Option 1&lt;br/&gt;
 *             &lt;input type=&quot;radio&quot; name=&quot;q1&quot; value=&quot;b&quot;&gt; Option 2&lt;br/&gt;
 *         &lt;/div&gt;  
 *     &lt;/div&gt;  
 *     &lt;!-- Question 2 --&gt;  
 *     &lt;div class=&quot;quizlib-question my-class&quot;&gt;  
 *         &lt;div class=&quot;quizlib-question-title&quot;&gt;2. Question Title&lt;/div&gt;  
 *         &lt;div class=&quot;quizlib-question-answers&quot;&gt;
 *             &lt;ul&gt;  
 *                 &lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;q2&quot; value=&quot;a&quot;&gt; Option 1&lt;/label&gt;&lt;/li&gt;  
 *                 &lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;q2&quot; value=&quot;b&quot;&gt; Option 2&lt;/label&gt;&lt;/li&gt;  
 *                 &lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;q2&quot; value=&quot;c&quot;&gt; Option 3&lt;/label&gt;&lt;/li&gt;  
 *                 &lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; name=&quot;q2&quot; value=&quot;d&quot;&gt; Option 4&lt;/label&gt;&lt;/li&gt;  
 *             &lt;/ul&gt;  
 *         &lt;/div&gt;  
 *     &lt;/div&gt;
 *     &lt;!-- Answer Button --&gt;
 *     &lt;button type=&quot;button&quot; onclick=&quot;myAnswerCheckMethod();&quot;&gt;Check Answers&lt;/button&gt;
 * &lt;/div&gt;
 * &#x60;&#x60;&#x60;
 * 
 *
 * **JavaScript**  
 * - Create a new Quiz object where the first parameter is the ID of your quiz container and the second parameter is an array of question answers (input values) in order.
 * - To check answers, call {{#crossLink &quot;Quiz/checkAnswers:method&quot;}}{{/crossLink}} which returns false if some questions have been skipped and marks them with a message appended to the title. Otherwise returns true and updates {{#crossLink &quot;Quiz/result:property&quot;}}{{/crossLink}}
 * - You can then access score data through {{#crossLink &quot;Quiz/result:property&quot;}}{{/crossLink}} which is a {{#crossLink &quot;QuizResult&quot;}}{{/crossLink}} object.
 * 
 * *Example*  
 * 
 * Create the quiz instance  
 * &#x60;&#x60;&#x60;
 * var quiz = new Quiz(&#x27;quiz-div&#x27;, [&#x27;a&#x27;, [&#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;]]);
 * &#x60;&#x60;&#x60;  
 * Create a method to check the answers
 * &#x60;&#x60;&#x60;
 * function myAnswerCheckMethod() {
 *     // checkAnswers returns true if all questions have been answered and updates the result object
 *     if (quiz.checkAnswers()) {
 *         console.log(&#x27;Correct answers: &#x27; + quiz.result.score + &#x27;/&#x27; + quiz.result.results.length);
 *         console.log(&#x27;Percent correct: &#x27; + quiz.result.scorePercentFormatted + &#x27;%&#x27;);
 *     }
 * &#x60;&#x60;&#x60;
 *
 * @class Quiz
 * @constructor
 * @param {String} quizContainer ID of the quiz container.
 * @param {Array} answers Array of correct answers using the input value. e.g. [&#x27;a&#x27;, &#x27;b&#x27;, [&#x27;a&#x27;, &#x27;b&#x27;]].
 *        Can use nested arrays for multi-answers such as checkbox questions
 * @example
 * 		new Quiz(&#x27;quiz-div&#x27;, [&#x27;a&#x27;, &#x27;b&#x27;, [&#x27;c&#x27;, &#x27;d&#x27;], &#x27;b&#x27;, [&#x27;a&#x27;, &#x27;b&#x27;]]);
 */
var Quiz = function(quizContainer, answers) {
	/**
	 * Enum containing classes used by QuizLib as follows:
	 * - **QUESTION**: &#x27;quizlib-question&#x27;
	 *   - used to identify a question element
	 * - **QUESTION_TITLE**: &#x27;quizlib-question-title&#x27;
	 *   - used to identify the question title element
	 * - **QUESTION_WARNING**: &#x27;quizlib-question-answers&#x27;
	 *   - used to identify the element containing question answers
	 * - **QUESTION_ANSWERS**: &#x27;quizlib-question-warning&#x27;
	 *   - used by the &#x27;unanswered question warning&#x27; element
	 * - **CORRECT**: &#x27;quizlib-correct&#x27;
	 *   - added to question titles to highlight correctly answered questions.  
	 *     Use freely to take advantage of {{#crossLink &quot;Quiz/highlightResults:method&quot;}}{{/crossLink}} and {{#crossLink &quot;Quiz/clearHighlights:method&quot;}}{{/crossLink}}
	 * - **INCORRECT**: &#x27;quizlib-incorrect&#x27;
	 *   - added to question titles to highlight incorrectly answered questions.  
	 *     Use freely to take advantage of {{#crossLink &quot;Quiz/highlightResults:method&quot;}}{{/crossLink}} and {{#crossLink &quot;Quiz/clearHighlights:method&quot;}}{{/crossLink}}
	 * 
	 * @property Classes
	 * @type Object
	 * @default See above
	 * @final
	 */
	this.Classes = Object.freeze({
		QUESTION: &quot;quizlib-question&quot;, 
		QUESTION_TITLE: &quot;quizlib-question-title&quot;,
		QUESTION_ANSWERS: &quot;quizlib-question-answers&quot;,
		QUESTION_WARNING: &quot;quizlib-question-warning&quot;,
		CORRECT: &quot;quizlib-correct&quot;,
		INCORRECT: &quot;quizlib-incorrect&quot;
	});
	
	/*this.QUESTION_CLASS = &#x27;quizlib-question&#x27;;
	this.QUESTION_TITLE_CLASS= &#x27;quizlib-question-title&#x27;;
	this.ANSWER_CLASS = &#x27;quizlib-question-answers&#x27;;
	this.QUESTION_WARNING_CLASS = &#x27;quizlib-question-warning&#x27;;
	this.CORRECT_CLASS = &#x27;quizlib-correct&#x27;;
	this.INCORRECT_CLASS = &#x27;quizlib-incorrect&#x27;;*/

	this.unansweredQuestionText = &#x27;Unanswered Question!&#x27;;

	// Quiz container element
	this.container = document.getElementById(quizContainer);
	this.questions = [];
	/**
	 * Quiz Result object containing quiz score information. See {{#crossLink &quot;QuizResult&quot;}}{{/crossLink}}
	 *
	 * @property result
	 * @type QuizResult
	 */
	this.result = new QuizResult();
	/**
	 * User defined answers taken from constructor
	 *
	 * @property answers
	 * @type Array
	 */
	this.answers = answers;

	// Get all the questions and add element to the questions array
	for (var i=0; i &lt; this.container.children.length; i++) {
		if (this.container.children[i].classList.contains(this.Classes.QUESTION)) {
			this.questions.push(this.container.children[i]);
		}
	}

	if (this.answers.length != this.questions.length) {
		throw new Error(&quot;Number of answers does not match number of questions!&quot;);
	}
};

/**
 * Checks quiz answers against provided answers. Calls {{#crossLink &quot;Quiz/clearHighlights:method&quot;}}{{/crossLink}} for each question.
 *
 * @method checkAnswers
 * @param {Boolean} [flagUnanswered=true] Whether to ignore unanswered questions. If false, unanswered questions will not be flagged
 * @return {Boolean} True or if *flagUnanswered* is true: True if all questions have been answered. Otherwise false and unanswered questions are highlighted.
 */
Quiz.prototype.checkAnswers = function(flagUnanswered) {
	if (flagUnanswered === undefined) flagUnanswered = true;
	var unansweredQs = [];
	var questionResults = [];
	for (var i=0; i &lt; this.questions.length; i++) {
		var question = this.questions[i];
		var answer = this.answers[i];
		var userAnswer = [];
		
		this.clearHighlights(question);
		
		// Get answers
		var answerInputs = question.getElementsByClassName(this.Classes.QUESTION_ANSWERS)[0].getElementsByTagName(&#x27;input&#x27;);
		var input;
		for (var k=0; k &lt; answerInputs.length; k++) {
			input = answerInputs[k];
			switch (input.type) {
				case &quot;checkbox&quot;:
				case &quot;radio&quot;:
					if (input.checked) userAnswer.push(input.value);
					break;
				default:
					if (input.value !== &#x27;&#x27;) userAnswer.push(input.value);
			}
		}
		// Remove single answer from array to match provided answer format
		if (userAnswer.length == 1 &amp;&amp; !Array.isArray(answer)) {
			userAnswer = userAnswer[0];
		} else if (userAnswer.length === 0) {
			unansweredQs.push(question);
		}
		
		questionResults.push(Utils.compare(userAnswer, answer));
	}

	if (unansweredQs.length === 0 || !flagUnanswered) {
		this.result.setResults(questionResults);
		return true;
	}
	else {
		// Highlight unanswered questions if set
		for (i=0; i &lt; unansweredQs.length; i++) {
			var warning = document.createElement(&#x27;span&#x27;);
			warning.appendChild(document.createTextNode(this.unansweredQuestionText));
			warning.className = this.Classes.QUESTION_WARNING;
			unansweredQs[i].getElementsByClassName(this.Classes.QUESTION_TITLE)[0].appendChild(warning);
		}
	}
	return false;
};

/**
 * Clears highlighting for a question element (correct and incorrect classes), including unanswered question warnings
 * 
 * @method clearHighlights
 * @param {HTMLDocument} question Question element to clear
 */
Quiz.prototype.clearHighlights = function(question) {
	// Remove question warning if it exists
	var questionWarnings = question.getElementsByClassName(this.Classes.QUESTION_WARNING);
	for (var i=0; i &lt; questionWarnings.length; i++) {
		question.getElementsByClassName(this.Classes.QUESTION_TITLE)[0].removeChild(questionWarnings[i]);
	}
	
	// Remove highlighted elements
	var highlightedQuestions = [question.getElementsByClassName(this.Classes.CORRECT), question.getElementsByClassName(this.Classes.INCORRECT)];
	var highlightedElement;
	for (i=0; i &lt; highlightedQuestions.length; i++) {
		while (highlightedQuestions[i].length &gt; 0) {
			highlightedElement = highlightedQuestions[i][0];
			highlightedElement.classList.remove(this.Classes.CORRECT);
			highlightedElement.classList.remove(this.Classes.INCORRECT);
		}
	}
};

/** 
 * Highlights correctly and incorrectly answered questions by:  
 * - Adding the class &#x27;quizlib-correct&#x27; to correctly answered question titles
 * - Adding the class &#x27;quizlib-incorrect&#x27; to incorrectly answered question titles
 * 
 * @method highlightResults
 * @param {Function} [questionCallback] Optional callback for each question with the following arguments:
 * 1. Element: the question element
 * 2. Number: question number
 * 3. Boolean: true if correct, false if incorrect.  
 * 
 * This allows you to further customise the handling of answered questions (and decouples the library from a specific HTML structure), for example highlighting the correct answer(s) on incorrect questions.
 * 
 * @example
 * &#x60;&#x60;&#x60;
 *    // Method Call
 *    quiz.highlightResults(handleAnswers);
 *    
 *    // handleAnswers callback
 *    function handleAnswers(questionElement, questionNo, correctFlag) {
 *        ...
 *    }
 * &#x60;&#x60;&#x60;
 */
Quiz.prototype.highlightResults = function(questionCallback) {
	var question;
	for (var i=0; i &lt; this.questions.length; i++) {
		question = this.questions[i];
		if (this.result.results[i]) {
			question.getElementsByClassName(this.Classes.QUESTION_TITLE)[0].classList.add(this.Classes.CORRECT);
			if (questionCallback !== undefined) questionCallback(question, i, true);
		}
		else {
			question.getElementsByClassName(this.Classes.QUESTION_TITLE)[0].classList.add(this.Classes.INCORRECT);
			if (questionCallback !== undefined) questionCallback(question, i, false);
		}
	}
};


/**
 * Quiz Result class that holds score information
 *
 * @class QuizResult
 * @constructor
 */
var QuizResult = function() {
	/**
	 * Array of booleans where the index is the question number and the value is whether the question was answered correctly. Updated by {{#crossLink &quot;QuizResult/setResults:method&quot;}}{{/crossLink}}
	 * @property results
	 * @type Array
	 */
	this.results = [];
	/**
	 * Number of questions answered correctly. Updated by {{#crossLink &quot;QuizResult/setResults:method&quot;}}{{/crossLink}}
	 * @property results
	 * @type Array
	 */
	this.totalQuestions = 0;
	/**
	 * Number of questions answered correctly. Updated by {{#crossLink &quot;QuizResult/setResults:method&quot;}}{{/crossLink}}
	 * @property score
	 * @type Number
	 */
	this.score = 0;
	/**
	 * Percentage score between 0 and 1. Updated by {{#crossLink &quot;QuizResult/setResults:method&quot;}}{{/crossLink}}
	 * @property scorePercent
	 * @type Number
	 */
	this.scorePercent = 0;
	/**
	 * Formatted score percent that&#x27;s more useful to humans (1 - 100). Percent is rounded down. Updated by {{#crossLink &quot;QuizResult/setResults:method&quot;}}{{/crossLink}}
	 * @property scorePercentFormatted
	 * @type Number
	 */
	this.scorePercentFormatted = 0;
};

/**
 * Calculates score information from an array of question results and updates properties
 *
 * @method setResults
 * @param {Array} questionResults Array of question results where the index is the question number and the value is whether the question was answered correctly. e.g. [true, true, false]
 */
QuizResult.prototype.setResults = function(questionResults) {
	this.results = questionResults;
	this.totalQuestions = this.results.length;
	this.score = 0;
	for (var i=0; i &lt; this.results.length; i++) {
		if (this.results[i]) this.score++;
	}
	this.scorePercent = this.score / this.totalQuestions;
	this.scorePercentFormatted = Math.floor(this.scorePercent * 100);
};


/**
 * Utils class that provides useful methods
 *
 * @class Utils
 */
var Utils = function() {};
/**
 * Compare two objects without coercion. If objects are arrays, their contents will be compared, including order.
 *
 * @method compare
 * @param {Object} obj1 main object
 * @param {Object} obj2 object to compare obj1 against
 * @return {boolean} True if objects are equal
 */
Utils.compare = function(obj1, obj2) {
	if (obj1.length != obj2.length) return false;

	if (Array.isArray(obj1) &amp;&amp; Array.isArray(obj2)) {
		for (var i=0; i &lt; obj1.length; i++) {
			if (obj1[i] !== obj2[i]) return false;
		}
		return true;
	}
	return obj1 === obj2;
};
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
